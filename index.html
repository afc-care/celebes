<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamic iframe with desktop user agent</title>
</head>
<body>
  <iframe
    id="videoIframe"
    width="636"
    height="360"
    frameborder="0"
    allowfullscreen
  ></iframe>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const number = urlParams.get('number');
    const id = urlParams.get('id') || '1';
    const iframe = document.getElementById('videoIframe');

    async function loadVideo() {
      if (!number) {
        iframe.src = "https://videocelebs.net/embed/95224";
        return;
      }

      if (id === '1') {
        const url = `https://www.vivatube.club/video/download/save/${number}`;

        try {
          // Try to fetch using desktop User-Agent
          const response = await fetch(url, {
            headers: {
              "User-Agent":
                "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",
              "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
            },
          });

          if (!response.ok) throw new Error("Request failed");
          const html = await response.text();

          // Inject the HTML into iframe using srcdoc
          iframe.srcdoc = html;
        } catch (error) {
          console.error("Error loading vivatube:", error);
          // Fallback if blocked by CORS
          iframe.src = url; 
        }
      } else {
        iframe.src = `https://videocelebs.net/embed/${number}`;
      }
    }

    loadVideo();
  </script>
</body>
</html>
